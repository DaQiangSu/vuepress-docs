(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{381:function(s,a,t){"use strict";t.r(a);var e=t(25),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"elasticsearch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch"}},[s._v("#")]),s._v(" Elasticsearch")]),s._v(" "),t("h3",{attrs:{id:"linux安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux安装"}},[s._v("#")]),s._v(" Linux安装")]),s._v(" "),t("blockquote",[t("p",[s._v("下载地址:https://www.elastic.co/cn/downloads/elasticsearch")])]),s._v(" "),t("blockquote",[t("p",[s._v("解压：")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf elasticsearch-7.9.2-linux-x86_64.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" elasticsearch-7.9.2 elasticsearch\n")])])]),t("blockquote",[t("p",[s._v("添加账户和权限")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" elastic\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" elastic -g elastic\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" elastic\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cd elsearch目录下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R elastic:elastic  elasticsearch\n")])])]),t("blockquote",[t("p",[s._v("修改config下配置文件elasticsearch.yml")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果设置127.0.0.1 设置为本机IP则为集群模式，需要配置安全机制")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先切换到对应的用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" elastic\nnode.name: node-1\npath.data: /data/elk/elasticsearch/data\npath.logs: /data/elk/elasticsearch/logs\nnetwork.host: 本机IP或者127.0.0.1\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#写这个任意端口都可以访问")]),s._v("\nhttp.host: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#端口号")]),s._v("\nhttp.port: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用密码 进入安全机制  需要进行下一步安装证书才可以正常启动")]),s._v("\nxpack.security.enabled: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用默认密码")]),s._v("\nxpack.security.authc.accept_default_password: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("解决报错")])]),s._v(" "),t("p",[s._v("[1]max file descriptors [4096] for elasticsearch process is too low, increase to at least [65535]")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/security/limits.conf\n* soft nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\n* hard nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -H -n\n")])])]),t("p",[s._v("[2]elasticsearch max virtual memory areas vm.max_map_count [65530] is too low, increase to at le")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sysctl.conf\nvm.max_map_count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("655360")]),s._v("\nsysctl -p\n")])])]),t("p",[s._v("[3]Transport SSL must be enabled if security is enabled on a [basic] license. Please set [xpack.security.transport.ssl.enabled] to [true] or disable security by setting [xpack.security.enabled] to [false]")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#绑定IP为固定IP 上面的错出现 执行如下操作生成证书")]),s._v("\nbin/elasticsearch-certutil ca\nENTER ENTER\nbin/elasticsearch-certutil cert --ca elastic-stack-ca.p12\nENTER ENTER ENTER\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#生成的证书移动到config/certs目录下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" elastic-certificates.p12 config/certs/\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#HTTP层TLS/SSL加密传输(集群之间的传输)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置完密码在加到配置文件")]),s._v("\nxpack.security.transport.ssl.enabled: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nxpack.security.transport.ssl.verification_mode: certificate\nxpack.security.transport.ssl.keystore.path: certs/elastic-certificates.p12\nxpack.security.transport.ssl.truststore.path: certs/elastic-certificates.p12\n")])])]),t("blockquote",[t("p",[s._v("启动")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /bin\n./elasticsearh\n")])])]),t("blockquote",[t("p",[s._v("如果打开了密码，需要设置用户密码(账户为kibnan无权限，超管elastic有权限)")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./elasticsearch-setup-passwords interactive\nenter password\n")])])]),t("blockquote",[t("p",[s._v("开放端口")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("firewall-cmd --zone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("/tcp --permanent\nfirewall-cmd --reload\n")])])]),t("blockquote",[t("p",[s._v("安装插件，为了更好的展示数据（安装后重启）")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#地图")]),s._v("\nbin/elasticsearch-plugin "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ingest-geoip\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#浏览器")]),s._v("\nbin/elasticsearch-plugin "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ingest-user-agent\n")])])]),t("h3",{attrs:{id:"window安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#window安装"}},[s._v("#")]),s._v(" Window安装")]),s._v(" "),t("blockquote",[t("p",[s._v("和Linux很像，只不过是下载的压缩包")])])])}),[],!1,null,null,null);a.default=n.exports}}]);